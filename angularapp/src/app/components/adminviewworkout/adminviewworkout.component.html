<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<div class="container mt-4">
  <h2 class="text-center mb-4">Workouts</h2>

  <div class="input-group mb-3">
    <input type="text" class="form-control" placeholder="Search" [(ngModel)]="searchTerm" (input)="search()" />
    <div class="dropdown ms-2">
      <button class="btn btn-outline-secondary" type="button" data-bs-toggle="dropdown">
        <i class="bi bi-gear"></i>
      </button>
      <ul class="dropdown-menu p-2">
        <li *ngFor="let column of columnSettings">
          <input type="checkbox" class="form-check-input me-2" [(ngModel)]="column.visible" />
          {{ column.label }}
        </li>
      </ul>
    </div>
  </div>

  <div class="mb-3">
    <button class="btn btn-sm btn-outline-secondary me-2" (click)="applyFilter('All')">All</button>
    <button class="btn btn-sm btn-outline-success me-2" (click)="applyFilter('Easy')">Easy</button>
    <button class="btn btn-sm btn-outline-warning me-2" (click)="applyFilter('Medium')">Medium</button>
    <button class="btn btn-sm btn-outline-danger" (click)="applyFilter('Hard')">Hard</button>
  </div>

  <table class="table table-bordered table-striped text-center">
    <thead class="table-primary">
      <tr>
        <th>S.No</th>
        <th *ngIf="isColumnVisible('name')">Workout Name</th>
        <th *ngIf="isColumnVisible('description')">Description</th>
        <th *ngIf="isColumnVisible('difficultyLevel')">Difficulty Level</th>
        <th *ngIf="isColumnVisible('targetArea')">Target Area</th>
        <th *ngIf="isColumnVisible('daysPerWeek')">Days Per Week</th>
        <th *ngIf="isColumnVisible('duration')">Duration (Minutes)</th>
        <th *ngIf="isColumnVisible('createdAt')">Created At</th>
        <th *ngIf="isColumnVisible('action')">Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngIf="filteredWorkouts.length === 0">
        <td colspan="9">Oops! No records found</td>
      </tr>
      <tr *ngFor="let workout of filteredWorkouts; let i = index">
        <td>{{ i + 1 }}</td>
        <td *ngIf="isColumnVisible('name')">{{ workout.name }}</td>
        <td *ngIf="isColumnVisible('description')">{{ workout.description }}</td>
        <td *ngIf="isColumnVisible('difficultyLevel')">{{ workout.difficultyLevel }}</td>
        <td *ngIf="isColumnVisible('targetArea')">{{ workout.targetArea }}</td>
        <td *ngIf="isColumnVisible('daysPerWeek')">{{ workout.daysPerWeek }}</td>
        <td *ngIf="isColumnVisible('duration')">{{ workout.duration }}</td>
        <td *ngIf="isColumnVisible('createdAt')">{{ workout.createdAt | date:'MM/dd/yy' }}</td>
        <td *ngIf="isColumnVisible('action')">
          <button class="btn btn-success btn-sm me-2">Edit</button>
          <button class="btn btn-danger btn-sm" (click)="deleteWorkout(workout._id)">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>